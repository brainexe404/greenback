<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Greenback ($GBACK)</title>

<style>
  *,*::before,*::after{box-sizing:border-box}
  :root{
    --bg:#0b0b0b;
    --card:#101010;
    --ink:#eaeaea;
    --muted:#bdbdbd;
    --yellow:#c8ff2f;
    --green:#2dff6a;
  }

  body{margin:0;background:var(--bg);color:var(--ink);font-family:Arial, Helvetica, sans-serif;}

  /* CRT overlay */
  body::before{
    content:"";position:fixed;inset:0;pointer-events:none;z-index:2;
    background:repeating-linear-gradient(to bottom, rgba(255,255,255,.06) 0 1px, rgba(0,0,0,0) 3px 6px);
    opacity:.08;mix-blend-mode:overlay;
  }
  body::after{
    content:"";position:fixed;inset:0;pointer-events:none;z-index:1;
    background:rgba(255,255,255,.02);
    opacity:0;
    animation:crtFlicker 7s steps(1,end) infinite;
  }
  @keyframes crtFlicker{
    0%,52%,100%{opacity:0}
    53%{opacity:.05}
    54%{opacity:0}
    78%{opacity:.03}
    79%{opacity:0}
  }

  /* keep content above CRT */
  .wrap,.card{position:relative;z-index:5}

  .wrap{
    min-height:100dvh;
    display:flex;
    align-items:center;
    justify-content:center;
    padding:18px;
    padding-bottom:calc(12px + env(safe-area-inset-bottom));
  }

  .card{
    width:100%;
    max-width:520px;
    background:var(--card);
    border:4px solid #000;
    box-shadow:0 0 0 4px #1a1a1a;
    padding:18px;
    text-align:center;
    position:relative; /* for mute button */
  }

  /* (1) Mute toggle (text icon) */
  .mute{
    position:absolute;top:10px;right:10px;
    width:44px;height:36px;
    border:3px solid #000;
    box-shadow:3px 3px 0 #000;
    background:#0b0b0b;color:var(--yellow);
    font-family:ui-monospace, Menlo, Consolas, monospace;
    font-weight:900;
    cursor:pointer;
    display:flex;align-items:center;justify-content:center;
    user-select:none;
  }
  .mute:active{transform:translate(2px,2px);box-shadow:1px 1px 0 #000}

  .logo{
    width:240px;height:240px;max-width:100%;
    border:4px solid #000;background:#0b0b0b;
    image-rendering:pixelated;
    display:block;margin:0 auto;
    animation:bob 2.4s steps(2,end) infinite;
    will-change:transform;
  }
  @keyframes bob{
    0%,50%,100%{transform:translateY(0)}
    25%,75%{transform:translateY(-2px)}
  }

  h1{margin:12px 0 4px;font-size:34px}
  .ticker{color:var(--muted);margin-bottom:8px}

  /* DEGEN flicker (PC safe) + clickable for easter egg */
  .degen{
    display:inline-block;margin:6px 0 12px;padding:6px 10px;
    border:3px solid #000;background:#0b0b0b;box-shadow:3px 3px 0 #000;
    font-family:ui-monospace, Menlo, Consolas, monospace;
    font-weight:900;letter-spacing:1px;text-transform:uppercase;
    color:var(--yellow);
    animation:blink 1s steps(1,end) infinite;
    user-select:none;
    cursor:pointer;
  }
  @keyframes blink{0%,49%{opacity:1}50%,100%{opacity:0}}

  .terminal{
    margin:0 auto 12px;width:100%;
    border:3px solid #000;box-shadow:3px 3px 0 #000;background:#0b0b0b;
    padding:10px 12px;text-align:left;
    font-family:ui-monospace, Menlo, Consolas, monospace;
    font-size:12px;line-height:1.45;
    color:#cfcfcf;user-select:none;
    position:relative;             /* for coin animation */
    overflow:hidden;               /* keep coin inside */
  }

  .prompt{color:var(--yellow);font-weight:900}
  .dim{color:#9a9a9a}

  /* READY should be YELLOW + flicker */
  .ready{
    color:var(--yellow);
    font-weight:900;
    animation:readyFlicker 1s steps(1,end) infinite;
  }
  @keyframes readyFlicker{
    0%,76%{opacity:1}
    77%{opacity:.2}
    78%{opacity:1}
    92%{opacity:.35}
    93%{opacity:1}
  }

  .cursor{
    display:inline-block;width:8px;height:12px;background:var(--yellow);
    margin-left:6px;transform:translateY(2px);
    animation:cursorBlink .8s steps(1,end) infinite;
  }
  @keyframes cursorBlink{0%,49%{opacity:1}50%,100%{opacity:0}}

  .term-icon{
    width:14px;height:14px;margin-left:6px;
    image-rendering:pixelated;vertical-align:-2px;
  }

  /* (2) Coin insert animation */
  .coin{
    position:absolute;
    left:14px; top:-26px;
    width:18px;height:18px;
    border:3px solid #000;
    box-shadow:3px 3px 0 #000;
    background:var(--yellow);
    opacity:0;
    pointer-events:none;
  }
  .coin.drop{
    opacity:1;
    animation:coinDrop 520ms steps(8,end) 1;
  }
  @keyframes coinDrop{
    0%{transform:translateY(-8px)}
    70%{transform:translateY(78px)}
    100%{transform:translateY(72px)}
  }
  .terminal.flash{
    animation:termFlash 140ms steps(2,end) 2;
  }
  @keyframes termFlash{
    0%{filter:brightness(1)}
    50%{filter:brightness(1.3)}
    100%{filter:brightness(1)}
  }

  .btn{
    width:100%;
    display:flex;align-items:center;justify-content:center;gap:14px;
    margin:12px 0;padding:16px 14px;min-height:56px;
    font-weight:900;text-transform:uppercase;text-decoration:none;
    border:4px solid #000;box-shadow:4px 4px 0 #000;
    user-select:none;cursor:pointer;
  }
  .btn:active{transform:translate(2px,2px);box-shadow:2px 2px 0 #000}
  button.btn{background:none;font:inherit;outline:none;appearance:none}

  .btn-yellow{background:var(--yellow);color:#0b0b0b}
  .btn-green{background:var(--green);color:#0b0b0b}

  /* CA button forced white + readable */
  .btn-ca{background:#fff !important;color:#0b0b0b !important;}
  .btn-ca .mono{color:#0b0b0b !important;}

  /* 2x bigger icons */
  .icon{width:36px;height:36px;image-rendering:pixelated;flex:0 0 auto}

  .mono{
    font-family:ui-monospace, Menlo, Consolas, monospace;
    font-size:14px;font-weight:900;text-transform:none;
    overflow:hidden;white-space:nowrap;text-overflow:ellipsis;
  }

  .hint{
    font-family:ui-monospace, Menlo, Consolas, monospace;
    font-size:11px;color:#8d8d8d;
    margin-top:-6px;margin-bottom:8px;
    user-select:none;
  }

  .ca-wrap{position:relative}
  .tooltip{
    position:absolute;top:-36px;left:50%;transform:translateX(-50%);
    background:#0b0b0b;color:var(--yellow);
    border:3px solid #000;box-shadow:3px 3px 0 #000;
    padding:6px 10px;
    font-family:ui-monospace, Menlo, Consolas, monospace;
    font-weight:900;letter-spacing:1px;text-transform:uppercase;
    opacity:0;pointer-events:none;
    transition:opacity .12s steps(1,end), transform .12s steps(1,end);
    white-space:nowrap;
  }
  .tooltip.show{opacity:1;transform:translateX(-50%) translateY(-4px)}

  .baron-line{
    margin-top:8px;width:100%;
    text-align:left;position:relative;
    font-family:ui-monospace, Menlo, Consolas, monospace;
    font-size:12px;line-height:1.45;
    user-select:none;
  }

  /* Glitch wipe */
  .glitchwipe{
    position:absolute;left:-10%;top:2px;width:120%;height:16px;
    pointer-events:none;opacity:0;
    background:linear-gradient(90deg,
      rgba(45,255,106,0) 0%,
      rgba(45,255,106,.35) 10%,
      rgba(200,255,47,.70) 45%,
      rgba(255,255,255,.35) 55%,
      rgba(45,255,106,.25) 75%,
      rgba(45,255,106,0) 100%);
    mix-blend-mode:screen;filter:contrast(1.15);
  }
  .baron-line.glitch .glitchwipe{opacity:1;animation:glitchWipe 220ms steps(6,end) 1;}
  @keyframes glitchWipe{
    0%{transform:translateX(-40%) skewX(-18deg)}
    35%{transform:translateX(5%) skewX(22deg)}
    70%{transform:translateX(35%) skewX(-12deg)}
    100%{transform:translateX(55%) skewX(18deg);opacity:0}
  }

  /* ---- MOBILE FIT (your perfect phone sizing) ---- */
  @media (max-width:420px){
    .wrap{align-items:flex-start}
    .card{padding:10px;margin-top:6px}
    .logo{width:150px;height:150px}
    h1{font-size:26px;margin:6px 0 2px}
    .terminal{font-size:11px;padding:8px 10px;line-height:1.35}
    .btn{margin:8px 0;padding:12px 10px;min-height:48px}
    .icon{width:28px;height:28px}
    .baron-line{font-size:11px;margin-top:4px}
    .hint{margin-bottom:4px}
    .mute{top:8px;right:8px}
  }
  @media (max-width:420px) and (max-height:740px){
    .logo{width:135px;height:135px}
    .terminal{font-size:10.5px;padding:7px 9px}
    .btn{min-height:44px;margin:7px 0}
    .icon{width:26px;height:26px}
    .hint{font-size:10px}
  }
  @media (max-width:420px) and (max-height:690px){
    .card{
      max-height:calc(100dvh - 18px - env(safe-area-inset-bottom));
      overflow:auto;
      -webkit-overflow-scrolling:touch;
    }
  }

  /* IMPORTANT: keep arcade animations even if reduce-motion is enabled */
  @media (prefers-reduced-motion: reduce){
    .logo{animation:bob 2.4s steps(2,end) infinite !important;}
    .degen{animation:blink 1s steps(1,end) infinite !important;}
    .cursor{animation:cursorBlink .8s steps(1,end) infinite !important;}
    .ready{animation:readyFlicker 1s steps(1,end) infinite !important;}
  }
</style>
</head>

<body>
<div class="wrap">
  <div class="card">

    <!-- (1) Mute toggle -->
    <button class="mute js-click" id="muteBtn" type="button" aria-label="Toggle sound">ðŸ”Š</button>

    <img class="logo" src="logo.png" alt="Greenback logo" />

    <h1>Greenback</h1>
    <div class="ticker">$GBACK</div>

    <!-- (4) Easter egg: click DEGEN 5x -->
    <div class="degen" id="degenBtn" title="...">DEGEN</div>

    <div class="terminal" id="terminal" aria-label="status terminal">
      <!-- (2) coin element -->
      <span class="coin" id="coin" aria-hidden="true"></span>

      <div><span class="prompt">&gt;</span> <span id="termLine1" class="dim"></span></div>
      <div><span class="prompt">&gt;</span> <span id="termLine2" class="dim"></span></div>
      <div><span class="prompt">&gt;</span> <span id="termLine3" class="dim"></span><span class="cursor"></span></div>
    </div>

    <a class="btn btn-yellow js-click" id="insertBtn" href="#" target="_blank" rel="noopener" aria-label="Insert coins">
      <img class="icon" id="pumpIcon" src="pump.png" alt="" aria-hidden="true">
      INSERT COINS
    </a>

    <a class="btn btn-green js-click" id="dexBtn" href="#" target="_blank" rel="noopener" aria-label="Open Dexscreener">
      <img class="icon" id="dexIcon" src="dex.png" alt="" aria-hidden="true">
      DEXSCREENER
    </a>

    <a class="btn btn-yellow js-click" id="xBtn" href="https://x.com/" target="_blank" rel="noopener" aria-label="Open X profile">
      <img class="icon" id="xIcon" src="x.png" alt="" aria-hidden="true">
      TWITTER
    </a>

    <div class="ca-wrap">
      <button class="btn btn-ca js-click" id="caBtn" type="button" aria-label="Copy contract address">
        <span class="tooltip" id="tip">COPIED!</span>
        <span class="mono" id="caText"></span>
      </button>
    </div>
    <div class="hint">tap to copy</div>

    <div class="baron-line" id="baronLine" aria-label="baron terminal line">
      <span class="glitchwipe" aria-hidden="true"></span>
      <span class="prompt">&gt;</span>
      <span id="baronTyped" class="ok"></span><span id="baronCursor" class="cursor"></span>
    </div>

  </div>
</div>

<!-- existing arcade click -->
<audio id="clickSfx" src="arcade.mp3" preload="auto"></audio>
<!-- (1) baron voice line (you uploaded) -->
<audio id="baronVoice" src="baron.mp3" preload="auto"></audio>

<script>
  // ===== CONFIG =====
  const CA = "AoRGp1U1zkW9rz8f9pJPRhhuhTtG3qDudjdajRaFpump";
  const INSERT_URL = "https://pump.fun";
  const DEX_URL = "https://dexscreener.com";
  const DEX_ICON = "dex.png"; // terminal icon

  // (3) terminal live status rotation
  const STATUS_LINES = [
    "loading greenback protocol v0.0.1",
    "syncing liquidity routes... OK",
    "scanning degen index... OK",
    "checking rugs... NOT FOUND",
    "loading memes... OK",
    "routing orders... STABLE"
  ];
  let statusIdx = 0;

  // links
  const insertBtn = document.getElementById("insertBtn");
  const dexBtn = document.getElementById("dexBtn");
  insertBtn.href = INSERT_URL;
  dexBtn.href = DEX_URL;

  // hide broken images (prevents broken-image squares)
  ["pumpIcon","dexIcon","xIcon"].forEach(id=>{
    const el=document.getElementById(id);
    if(!el) return;
    el.onerror=()=>{ el.style.display="none"; };
  });

  // CA short display, full copy
  const caTextEl = document.getElementById("caText");
  caTextEl.textContent = "CA: " + CA.slice(0,6) + "..." + CA.slice(-6);

  // ===== AUDIO (mute toggle + unlock + 2 channels) =====
  const muteBtn = document.getElementById("muteBtn");
  const sfxEl = document.getElementById("clickSfx");
  const baronElAudio = document.getElementById("baronVoice");

  // If you accidentally uploaded as baron.mps, try it as fallback:
  if(baronElAudio){
    baronElAudio.onerror = () => {
      // fallback attempt (won't throw if file doesn't exist)
      baronElAudio.src = "baron.mps";
    };
  }

  let audioCtx = null;
  let audioUnlocked = false;

  // persist mute
  let isMuted = (localStorage.getItem("gb_muted") === "1");
  function renderMute(){
    muteBtn.textContent = isMuted ? "ðŸ”‡" : "ðŸ”Š";
    if(sfxEl) sfxEl.muted = isMuted;
    if(baronElAudio) baronElAudio.muted = isMuted;
  }
  renderMute();

  muteBtn.addEventListener("click", (e)=>{
    // click sound still respects mute; toggle happens first
    isMuted = !isMuted;
    localStorage.setItem("gb_muted", isMuted ? "1" : "0");
    renderMute();
  });

  function ensureAudioUnlocked(){
    if(audioUnlocked) return;
    audioUnlocked = true;

    // resume WebAudio if needed
    try{
      audioCtx = audioCtx || new (window.AudioContext || window.webkitAudioContext)();
      if(audioCtx.state === "suspended") audioCtx.resume();
    }catch(e){}

    // prime <audio> elements silently on first gesture (helps iOS/Android)
    [sfxEl, baronElAudio].forEach(a=>{
      if(!a) return;
      try{
        const wasMuted = a.muted;
        a.muted = true;
        a.volume = 0.75;
        const p = a.play();
        if(p && p.then){
          p.then(()=>{ a.pause(); a.currentTime = 0; a.muted = wasMuted; })
           .catch(()=>{ a.muted = wasMuted; });
        }else{
          a.pause(); a.currentTime = 0; a.muted = wasMuted;
        }
      }catch(e){}
    });

    // if we were waiting to speak, do it now
    if(pendingBaronSpeak) {
      pendingBaronSpeak = false;
      maybePlayBaronOnce();
    }
  }

  function beepFallback(){
    try{
      audioCtx = audioCtx || new (window.AudioContext || window.webkitAudioContext)();
      const o = audioCtx.createOscillator();
      const g = audioCtx.createGain();
      o.type = "square";
      o.frequency.value = 740;
      g.gain.value = 0.045;
      o.connect(g); g.connect(audioCtx.destination);
      o.start();
      setTimeout(()=> o.stop(), 70);
    }catch(e){}
  }

  async function playClick(){
    ensureAudioUnlocked();
    if(isMuted) return;
    try{
      if(!sfxEl) return beepFallback();
      sfxEl.volume = 0.85;
      sfxEl.currentTime = 0;
      const p = sfxEl.play();
      if(p && typeof p.then === "function") await p;
    }catch{
      beepFallback();
    }
  }

  async function playBaronVoice(){
    ensureAudioUnlocked();
    if(isMuted) return;
    try{
      if(!baronElAudio) return;
      baronElAudio.volume = 0.75;
      baronElAudio.currentTime = 0;
      const p = baronElAudio.play();
      if(p && typeof p.then === "function") await p;
    }catch{
      // ignore; no fallback here
    }
  }

  // unlock on first user gesture anywhere
  window.addEventListener("pointerdown", ensureAudioUnlocked, {once:true, passive:true});
  window.addEventListener("touchstart", ensureAudioUnlocked, {once:true, passive:true});

  // play click sound on any clickables
  document.querySelectorAll(".js-click").forEach(el=>{
    el.addEventListener("click", ()=>{ playClick(); });
  });

  // ===== COPY CA =====
  const tip = document.getElementById("tip");
  let tipTimer;
  document.getElementById("caBtn").addEventListener("click", async ()=>{
    try{ await navigator.clipboard.writeText(CA); }
    catch{
      try{
        const t=document.createElement("textarea");
        t.value=CA; document.body.appendChild(t);
        t.select(); document.execCommand("copy");
        document.body.removeChild(t);
      }catch{
        window.prompt("Copy CA:", CA);
      }
    }
    tip.classList.add("show");
    clearTimeout(tipTimer);
    tipTimer=setTimeout(()=>tip.classList.remove("show"), 900);
  });

  // ===== (2) COIN INSERT ANIMATION =====
  const terminal = document.getElementById("terminal");
  const coin = document.getElementById("coin");

  function coinDrop(){
    if(!coin || !terminal) return;
    terminal.classList.remove("flash");
    coin.classList.remove("drop");
    void terminal.offsetWidth; // reflow
    terminal.classList.add("flash");
    coin.classList.add("drop");
    // clean up after animation
    setTimeout(()=> coin.classList.remove("drop"), 650);
    setTimeout(()=> terminal.classList.remove("flash"), 420);
  }

  // only on INSERT COINS (not all buttons)
  insertBtn.addEventListener("click", ()=>{ coinDrop(); }, {passive:true});

  // ===== (1) BARON VOICE ONCE PER SESSION (after boot) =====
  let pendingBaronSpeak = false;

  function maybePlayBaronOnce(){
    if(isMuted) return;
    if(sessionStorage.getItem("gb_baron_played") === "1") return;

    if(!audioUnlocked){
      pendingBaronSpeak = true;
      return;
    }
    sessionStorage.setItem("gb_baron_played", "1");
    playBaronVoice();
  }

  // ===== (4) EASTER EGG: click DEGEN 5x =====
  const degenBtn = document.getElementById("degenBtn");
  let degenClicks = 0;
  let degenTimer = null;
  let easterMode = false;

  function triggerEasterEgg(){
    // one-time per session voice line (separate from main)
    if(sessionStorage.getItem("gb_easter_voice_played") !== "1"){
      sessionStorage.setItem("gb_easter_voice_played", "1");
      playBaronVoice();
    }
    // force a special cycle immediately
    easterMode = true;
    runCycle(true);
    // reset easter mode after a bit so normal loop resumes
    setTimeout(()=>{ easterMode = false; }, 14000);
  }

  degenBtn.addEventListener("click", ()=>{
    degenClicks++;
    clearTimeout(degenTimer);
    degenTimer = setTimeout(()=>{ degenClicks = 0; }, 1400);
    if(degenClicks >= 5){
      degenClicks = 0;
      triggerEasterEgg();
    }
  });

  // ===== LOOP (terminal lines + baron) =====
  const line1 = document.getElementById("termLine1");
  const line2 = document.getElementById("termLine2");
  const line3 = document.getElementById("termLine3");

  const LOOP_MS = 10000;

  const baronTextNormal = "THE BARON ALWAYS EXITS FIRST";
  const baronTextEaster = "YOU SHOULDN'T BE HERE";
  const baronTyped = document.getElementById("baronTyped");
  const baronCursor = document.getElementById("baronCursor");
  const baronLine = document.getElementById("baronLine");

  let cycleTimers = [];
  function addTimeout(fn, ms){
    const t = setTimeout(fn, ms);
    cycleTimers.push(t);
    return t;
  }
  function typeText(el, text, speed, done){
    let i = 0;
    el.textContent = "";
    const t = setInterval(()=>{
      el.textContent += text[i++] || "";
      if(i >= text.length){
        clearInterval(t);
        done && done();
      }
    }, speed);
    cycleTimers.push(t);
  }

  function typeBaronOnce(text){
    baronLine.classList.remove("glitch");
    void baronLine.offsetWidth;
    baronLine.classList.add("glitch");

    baronTyped.textContent = "";
    baronCursor.style.display = "inline-block";

    addTimeout(()=>{
      let i = 0;
      const t = setInterval(()=>{
        baronTyped.textContent += text[i++] || "";
        if(i >= text.length){
          clearInterval(t);
          addTimeout(()=>{ baronCursor.style.display = "none"; }, 550);
        }
      }, 14);
      cycleTimers.push(t);
    }, 90);
  }

  function runCycle(forceNow=false){
    // clear both timeouts + intervals from previous cycle
    cycleTimers.forEach(id => { clearTimeout(id); clearInterval(id); });
    cycleTimers = [];

    // choose rotating status line
    const statusLine = STATUS_LINES[statusIdx % STATUS_LINES.length];
    statusIdx++;

    // reset
    line1.textContent = "";
    line2.textContent = "";
    line3.textContent = "";
    baronTyped.textContent = "";
    baronCursor.style.display = "none";

    // normal vs easter cycle text
    const l1 = easterMode ? "ACCESS GRANTED..." : "initializing degen terminal...";
    const l2 = easterMode ? "DEGEN OVERDRIVE ENABLED" : statusLine;

    typeText(line1, l1, 18, ()=>{
      addTimeout(()=> typeText(line2, l2, 14, ()=>{
        addTimeout(()=> typeText(line3, "status: ", 16, ()=>{
          line3.innerHTML =
            `status: <span class="ready">READY</span><img src="${DEX_ICON}" class="term-icon" alt="" aria-hidden="true">`;

          // speak once per session after boot completes
          maybePlayBaronOnce();

          // baron line (normal loop or easter egg)
          addTimeout(()=> typeBaronOnce(easterMode ? baronTextEaster : baronTextNormal), 220);
        }), 140);
      }), 140);
    });
  }

  runCycle();
  setInterval(runCycle, LOOP_MS);
</script>
</body>
</html>
