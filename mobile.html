
<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
<title>Baron Greenback ($GBARON) â€” MOBILE</title>

<style>
  *,*::before,*::after{box-sizing:border-box}
  :root{
    --bg:#070b10;
    --panel:#0d1320;
    --text:#eaf2ff;
    --muted:#93a4c7;
    --line:rgba(255,255,255,.10);
    --good:#2dff6a;
    --warn:#c8ff2f;
    --bad:#ff4d6d;
    --shadow: 0 14px 40px rgba(0,0,0,.55);
    --r:18px;
    --mono: ui-monospace, Menlo, Consolas, "SF Mono", monospace;
  }

  html,body{height:100%; margin:0}
  body{
    font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial;
    background:
      radial-gradient(900px 520px at 20% -10%, rgba(110,231,255,.16), transparent 55%),
      radial-gradient(700px 420px at 85% 10%, rgba(167,139,250,.16), transparent 60%),
      radial-gradient(700px 420px at 50% 110%, rgba(45,255,106,.10), transparent 60%),
      var(--bg);
    color:var(--text);
    overflow:hidden;
  }

  /* subtle CRT overlay */
  body::before{
    content:"";position:fixed;inset:0;pointer-events:none;z-index:2;
    background:repeating-linear-gradient(to bottom, rgba(255,255,255,.05) 0 1px, rgba(0,0,0,0) 3px 6px);
    opacity:.07;mix-blend-mode:overlay;
  }

  /* MOBILE STAGE */
  .stage{
    height:100dvh;
    padding:12px;
    padding-top:calc(12px + env(safe-area-inset-top));
    padding-bottom:calc(12px + env(safe-area-inset-bottom));
    display:flex;
    justify-content:center;
    align-items:stretch;
    position:relative;
    z-index:5;
  }

  .frame{
    width:100%;
    max-width:560px;
    height:100%;
    border-radius:24px;
    border:1px solid var(--line);
    background:linear-gradient(180deg, rgba(255,255,255,.05), rgba(255,255,255,.02));
    box-shadow:var(--shadow);
    overflow:hidden;
    display:flex;
    flex-direction:column;
    min-height:0;
  }

  /* HEADER */
  .header{
    padding:10px;
    border-bottom:1px solid var(--line);
    background:rgba(0,0,0,.22);
    display:flex;
    align-items:center;
    justify-content:space-between;
    gap:10px;
  }
  .brandLink{
    display:flex;align-items:center;gap:10px;min-width:0;
    text-decoration:none;color:inherit;
    padding:6px;border-radius:14px;
  }
  .brandLink:focus-visible{outline:2px solid rgba(110,231,255,.65); outline-offset:2px}
  .avatar{
    width:40px;height:40px;border-radius:12px;
    border:1px solid var(--line);
    background:rgba(255,255,255,.04);
    overflow:hidden;flex:0 0 auto;
  }
  .avatar img{width:100%;height:100%;object-fit:cover;image-rendering:pixelated}
  .brandText{min-width:0;display:flex;flex-direction:column;gap:2px}
  .title{
    font-weight:1000;font-size:15px;line-height:1.05;
    white-space:nowrap;overflow:hidden;text-overflow:ellipsis;
    letter-spacing:.2px;
  }
  .sub{
    font-size:11px;color:var(--muted);
    white-space:nowrap;overflow:hidden;text-overflow:ellipsis;
  }

  /* SOUND TOGGLE */
  .soundPill{
    display:flex;align-items:center;gap:8px;
    border:1px solid var(--line);
    background:rgba(255,255,255,.04);
    padding:8px 10px;
    border-radius:14px;
    flex:0 0 auto;
  }
  .soundLabel{font-family:var(--mono);font-size:11px;color:var(--muted);font-weight:900;letter-spacing:.3px}
  .soundToggle{
    height:30px;width:50px;border-radius:999px;border:1px solid var(--line);
    background:rgba(0,0,0,.20);position:relative;cursor:pointer;user-select:none;
  }
  .soundToggle::after{
    content:"";position:absolute;top:3px;left:3px;width:24px;height:24px;border-radius:999px;
    background:rgba(255,255,255,.10);border:1px solid var(--line);
    transition:transform .16s ease, background .16s ease;
  }
  .soundToggle.on::after{transform:translateX(20px); background:rgba(45,255,106,.18)}

  /* CONTENT (no scroll if possible) */
  .content{
    flex:1;
    min-height:0;
    display:flex;
    flex-direction:column;
    gap:10px;
    padding:10px;
  }

  .card{
    border:1px solid var(--line);
    background:rgba(0,0,0,.22);
    border-radius:18px;
    overflow:hidden;
  }

  /* TOP STATS + PRICE */
  .topBlock{padding:10px; display:flex; flex-direction:column; gap:10px;}
  .row{display:flex; gap:10px; flex-wrap:wrap;}
  .pill{
    flex:1; min-width:120px;
    border:1px solid var(--line);
    background:rgba(255,255,255,.04);
    border-radius:14px;
    padding:8px 10px;
  }
  .k{font-size:10px;color:var(--muted);letter-spacing:.5px;font-weight:900}
  .v{
    margin-top:2px;
    font-family:var(--mono);
    font-weight:1000;
    font-size:16px;
    display:flex;align-items:baseline;gap:8px;
    white-space:nowrap;
  }
  .pct{
    font-size:11px;
    font-weight:1000;
    padding:3px 8px;
    border-radius:999px;
    border:1px solid var(--line);
    background:rgba(45,255,106,.10);
    color:var(--good);
    font-family:var(--mono);
  }
  .rank-white{color:#fff}
  .rank-yellow{color:var(--warn)}
  .rank-green{color:var(--good)}
  .rank-red{color:var(--bad)}

  /* ACTIONS */
  .actions{
    padding:10px;
    display:flex;
    flex-direction:column;
    gap:10px;
  }
  .btn{
    appearance:none;border:none;border-radius:16px;
    padding:14px 14px;
    font-weight:1000;letter-spacing:.3px;
    cursor:pointer;
    color:#fff;
    border:1px solid var(--line);
    background:rgba(255,255,255,.06);
    display:flex;align-items:center;justify-content:center;gap:10px;
    user-select:none;-webkit-tap-highlight-color: transparent;
    transition:transform .06s ease, filter .2s ease;
  }
  .btn:active{transform:translateY(1px) scale(.99)}
  .btn:focus-visible{outline:2px solid rgba(110,231,255,.65); outline-offset:2px}

  .btn.insert{
    background:linear-gradient(135deg, rgba(45,255,106,1), rgba(45,255,106,.74));
    border-color:rgba(45,255,106,.55);
    box-shadow:0 0 0 1px rgba(0,0,0,.25) inset, 0 0 22px rgba(45,255,106,.14);
  }
  .btn.degen{
    background:linear-gradient(135deg, rgba(200,255,47,1), rgba(200,255,47,.78));
    border-color:rgba(200,255,47,.55);
    box-shadow:0 0 0 1px rgba(0,0,0,.25) inset, 0 0 22px rgba(200,255,47,.16);
  }
  .btn.rug{
    background:linear-gradient(135deg, rgba(255,77,109,.22), rgba(255,176,0,.10));
    border-color:rgba(255,77,109,.28);
  }

  /* subtle idle pulse (for CA + Pump when idle, not spammy) */
  .idlePulse{animation: idlePulse 2.8s ease-in-out infinite;}
  @keyframes idlePulse{
    0%,100%{filter:brightness(1); box-shadow:0 0 0 1px rgba(0,0,0,.25) inset, 0 0 18px rgba(200,255,47,.08)}
    50%{filter:brightness(1.06); box-shadow:0 0 0 1px rgba(0,0,0,.25) inset, 0 0 30px rgba(200,255,47,.16)}
  }

  /* CA */
  .caBtn{
    width:100%;
    text-align:left;
    border-radius:16px;
    border:1px solid rgba(200,255,47,.22);
    background:
      radial-gradient(800px 220px at 10% 30%, rgba(200,255,47,.18), transparent 45%),
      radial-gradient(700px 220px at 90% 60%, rgba(45,255,106,.10), transparent 45%),
      rgba(255,255,255,.04);
    padding:12px 12px;
    cursor:pointer;
    color:var(--text);
    position:relative;
    overflow:hidden;
    box-shadow: 0 0 0 1px rgba(0,0,0,.25) inset, 0 0 24px rgba(200,255,47,.10);
    user-select:none;-webkit-tap-highlight-color: transparent;
  }
  .caBtn:active{transform:translateY(1px) scale(.995)}
  .caTop{
    display:flex;align-items:center;justify-content:space-between;gap:10px;
    font-family:var(--mono);font-weight:1000;letter-spacing:.7px;font-size:11px;text-transform:uppercase;
    color:rgba(255,255,255,.78);
    margin-bottom:8px;
  }
  .caBig{
    font-family:var(--mono);
    font-weight:1000;
    font-size:14px;
    letter-spacing:.2px;
    line-height:1.25;
    overflow-wrap:anywhere;
  }
  .tapHint{
    padding:8px 2px 0;
    font-family:var(--mono);
    font-size:11px;
    color:var(--muted);
    letter-spacing:.2px;
    text-transform:uppercase;
  }
  .toast{
    position:absolute;top:10px;right:10px;
    font-family:var(--mono);font-weight:1000;font-size:11px;letter-spacing:.6px;text-transform:uppercase;
    background:rgba(0,0,0,.68);border:1px solid var(--line);padding:6px 8px;border-radius:999px;
    opacity:0;transform:translateY(-4px);
    transition:opacity .14s ease, transform .14s ease;
    pointer-events:none;color:var(--warn);
  }
  .toast.show{opacity:1; transform:translateY(0)}

  /* LINKS */
  .links{padding:10px; display:flex; flex-direction:column; gap:10px;}
  .linkBtn{
    display:flex;align-items:center;justify-content:center;gap:12px;
    border-radius:16px;border:1px solid var(--line);
    background:rgba(255,255,255,.04);
    padding:13px 12px;
    font-weight:1000;letter-spacing:.3px;text-transform:uppercase;
    cursor:pointer;user-select:none;-webkit-tap-highlight-color: transparent;
    text-decoration:none;color:#fff;
    position:relative;isolation:isolate;
  }
  .linkBtn:active{transform:translateY(1px) scale(.99)}
  .ico{width:22px;height:22px;image-rendering:pixelated;filter:drop-shadow(0 0 10px rgba(255,255,255,.12))}
  .linkBtn.pump{border-color:rgba(255,255,255,.18)}
  .grid2{display:grid;grid-template-columns:1fr 1fr;gap:10px;}
  .linkBtn.dex{
    background:linear-gradient(135deg, rgba(45,255,106,1), rgba(45,255,106,.72));
    border-color:rgba(45,255,106,.55);
  }
  .linkBtn.tw{
    background:linear-gradient(135deg, rgba(200,255,47,1), rgba(200,255,47,.78));
    border-color:rgba(200,255,47,.55);
  }

  /* TERMINAL (mini) */
  .term{
    padding:10px;
    font-family:var(--mono);
    font-size:12px;
    line-height:1.45;
    color:#cfd7ea;
  }
  .termLine{display:flex;gap:8px;align-items:baseline}
  .prompt{color:var(--warn);font-weight:1000}
  .dim{color:#94a4c2}
  .cursor{
    display:inline-block;width:8px;height:12px;background:var(--warn); margin-left:6px;
    transform:translateY(2px);
    animation:cursorPulse .75s steps(2,end) infinite;
    box-shadow:0 0 10px rgba(200,255,47,.18);
  }
  @keyframes cursorPulse{
    0%{opacity:1}
    50%{opacity:.22}
    100%{opacity:1}
  }

  /* Flash-glow helper (stronger DEGEN pump pulse) */
  .flashGlow{position:relative; isolation:isolate;}
  .flashGlow::after{
    content:"";
    position:absolute; inset:-10px;
    border-radius:20px;
    pointer-events:none;
    border:3px solid var(--flash, rgba(200,255,47,.85));
    box-shadow:
      0 0 0 2px rgba(0,0,0,.55) inset,
      0 0 28px var(--flash, rgba(200,255,47,.55)),
      0 0 90px var(--flash, rgba(200,255,47,.45));
    opacity:0;
    transform:scale(.98);
    animation:flashPop 520ms ease-out 1;
  }
  @keyframes flashPop{
    0%{opacity:0; transform:scale(.98)}
    35%{opacity:1; transform:scale(1.03)}
    100%{opacity:0; transform:scale(1)}
  }

  /* Small phones: tighten spacing */
  @media (max-height: 760px){
    .content{gap:8px}
    .topBlock,.actions,.links,.term{padding:9px}
    .btn{padding:13px 12px}
    .linkBtn{padding:12px 12px}
  }

  @media (prefers-reduced-motion: reduce){
    .idlePulse{animation:none !important}
    .cursor{animation:none !important}
  }
</style>
</head>

<body>
  <div class="stage">
    <div class="frame">
      <!-- HEADER -->
      <div class="header">
        <a class="brandLink" id="topPumpLink" href="https://pump.fun" target="_blank" rel="noopener noreferrer">
          <div class="avatar"><img src="logo.png" alt=""></div>
          <div class="brandText">
            <div class="title">Baron Greenback <span style="opacity:.85">($GBARON)</span></div>
            <div class="sub">arcade mode â€¢ tap everything â€¢ donâ€™t get rugged ðŸ’€</div>
          </div>
        </a>

        <div class="soundPill" aria-label="Sound">
          <div class="soundLabel"><span id="soundState">on</span></div>
          <div class="soundToggle on" id="soundToggle" role="switch" aria-checked="true" tabindex="0"></div>
        </div>
      </div>

      <div class="content">
        <!-- TOP -->
        <div class="card">
          <div class="topBlock">
            <div class="row">
              <div class="pill">
                <div class="k">COINS INSERTED</div>
                <div class="v"><span id="coinsInserted">0</span> <span style="font-size:11px;color:var(--muted);font-weight:900">clicks</span></div>
              </div>
              <div class="pill">
                <div class="k">RANK</div>
                <div class="v"><span id="rank" class="rank-white">paperhands</span></div>
              </div>
            </div>

            <div class="pill">
              <div class="k">FAKE PRICE</div>
              <div class="v">
                <span id="price">$0.000001</span>
                <span class="pct" id="pct">+0.00%</span>
              </div>
              <div style="margin-top:4px;font-size:11px;color:var(--muted)" id="priceNote">Totally organic growth (trust me bro)</div>
            </div>
          </div>
        </div>

        <!-- ACTIONS -->
        <div class="card">
          <div class="actions">
            <button class="btn insert" id="btnInsert">
              ðŸª™ INSERT COINS
            </button>

            <button class="btn degen" id="btnDegen">
              âš¡ <span id="degenLabel">ACTIVATE DEGEN</span>
            </button>

            <button class="btn rug" id="btnRug">
              ðŸ’€ RUG PULL
            </button>
          </div>
        </div>

        <!-- CA -->
        <div class="card">
          <div style="padding:10px;">
            <button class="caBtn idlePulse" id="caBtn" type="button" aria-label="Copy contract address">
              <span class="toast" id="toast">THE BARON APPROVES â€¢ SEE YOU AT ATH!</span>
              <div class="caTop">
                <span>CA</span>
                <span style="color:var(--warn)">$GBARON</span>
              </div>
              <div class="caBig" id="caText"></div>
            </button>
            <div class="tapHint">Tap to copy</div>
          </div>
        </div>

        <!-- LINKS -->
        <div class="card">
          <div class="links">
            <a class="linkBtn pump idlePulse" id="pumpBtn" href="https://pump.fun" target="_blank" rel="noopener noreferrer">
              <img class="ico" src="pump.png" alt="" aria-hidden="true"> PUMP.FUN
            </a>

            <div class="grid2">
              <a class="linkBtn dex" id="dexBtn" href="https://dexscreener.com" target="_blank" rel="noopener noreferrer">
                <img class="ico" src="dex.png" alt="" aria-hidden="true"> DEXSCREENER
              </a>
              <a class="linkBtn tw" id="xBtn" href="https://x.com/" target="_blank" rel="noopener noreferrer">
                <img class="ico" src="x.png" alt="" aria-hidden="true"> TWITTER
              </a>
            </div>
          </div>
        </div>

        <!-- MINI TERMINAL -->
        <div class="card">
          <div class="term" aria-label="Terminal">
            <div class="termLine"><span class="prompt">&gt;</span> <span class="dim" id="t1">INITIALIZING TERMINALâ€¦</span></div>
            <div class="termLine"><span class="prompt">&gt;</span> <span class="dim" id="t2">THE BARON ALWAYS EXITS FIRST</span></div>
            <div class="termLine"><span class="prompt">&gt;</span> <span class="dim" id="t3">READY FOR COINSâ€¦ INSERT TO BEGIN</span><span class="cursor"></span></div>
          </div>
        </div>

      </div>
    </div>
  </div>

<script>
/* =========================
   CONFIG (same vibe as desktop)
   ========================= */
const CA = "AoRGp1U1zkW9rz8f9pJPRhhuhTtG3qDudjdajRaFpump";

/* Local audio files */
const DEGEN_MP3 = "baron.mp3";
const LAUGH_MP3 = "laugh.mp3";

/* =========================
   ELEMENTS
   ========================= */
const elCoins = document.getElementById("coinsInserted");
const elRank  = document.getElementById("rank");
const elPrice = document.getElementById("price");
const elPct   = document.getElementById("pct");
const elNote  = document.getElementById("priceNote");

const btnInsert = document.getElementById("btnInsert");
const btnDegen  = document.getElementById("btnDegen");
const btnRug    = document.getElementById("btnRug");
const degenLabel= document.getElementById("degenLabel");

const caBtn  = document.getElementById("caBtn");
const caText = document.getElementById("caText");
const toast  = document.getElementById("toast");

const pumpBtn = document.getElementById("pumpBtn");
const dexBtn  = document.getElementById("dexBtn");
const xBtn    = document.getElementById("xBtn");
const topPumpLink = document.getElementById("topPumpLink");

const soundToggle = document.getElementById("soundToggle");
const soundState  = document.getElementById("soundState");

const t1 = document.getElementById("t1");
const t2 = document.getElementById("t2");
const t3 = document.getElementById("t3");

/* =========================
   STATE
   ========================= */
let coinsInserted = Number(sessionStorage.getItem("gbaron_m_coins") || "0");
if(!Number.isFinite(coinsInserted) || coinsInserted < 0) coinsInserted = 0;

const basePrice = 0.000001;
let price = Number(sessionStorage.getItem("gbaron_m_price") || String(basePrice));
if(!Number.isFinite(price) || price <= 0) price = basePrice;

let degenActive = false;
let audioEnabled = (sessionStorage.getItem("gbaron_m_sound") || "1") === "1";

/* =========================
   TERMINAL QUEUE (mini)
   ========================= */
const q = [];
let busy = false;

function enqueue(lines){
  for(const l of lines) q.push(l);
  if(!busy) pump();
}
function pump(){
  if(q.length === 0){ busy = false; return; }
  busy = true;
  const next = q.shift();
  t1.textContent = t2.textContent;
  t2.textContent = t3.textContent;
  typeInto(t3, next, 22, () => setTimeout(pump, 140));
}
function typeInto(el, text, cps, done){
  el.textContent = "";
  let i = 0;
  const stepMs = Math.max(10, Math.floor(1000 / cps));
  const timer = setInterval(() => {
    i++;
    el.textContent = text.slice(0, i);
    if(i >= text.length){
      clearInterval(timer);
      done && done();
    }
  }, stepMs);
}

/* =========================
   RANKS
   ========================= */
const ranks = [
  { min:0,   name:"paperhands", cls:"rank-white" },
  { min:10,  name:"hodler", cls:"rank-yellow" },
  { min:25,  name:"diamondhands", cls:"rank-green" },
  { min:45,  name:"degen", cls:"rank-yellow" },
  { min:70,  name:"baronâ€™s henchman", cls:"rank-green" },
  { min:100, name:"the baron", cls:"rank-yellow" },
];
function getRank(coins){
  let r = ranks[0];
  for(const x of ranks){ if(coins >= x.min) r = x; }
  return r;
}
function setRankUI(){
  const r = getRank(coinsInserted);
  elRank.textContent = r.name;
  elRank.classList.remove("rank-white","rank-yellow","rank-green","rank-red");
  elRank.classList.add(r.cls);
}

/* =========================
   PRICE MECHANICS (no chart, still fun)
   ========================= */
function fmtUSD(x){
  if (x >= 1) return "$" + x.toFixed(2);
  if (x >= 0.01) return "$" + x.toFixed(4);
  return "$" + x.toFixed(6);
}
function pumpPrice(mult=1){
  const chaos = degenActive ? 0.18 : 0.02;
  const base  = degenActive ? 0.12 : 0.010;
  const pct = (base*mult) + (Math.random()*chaos);

  const last = price;
  price = price * (1 + pct);

  const pctShow = ((price/last)-1)*100;
  elPrice.textContent = fmtUSD(price);
  elPct.textContent = (pctShow>=0?"+":"") + pctShow.toFixed(2) + "%";
  elPct.style.color = pctShow>=0 ? "var(--good)" : "var(--bad)";
  elPct.style.background = pctShow>=0 ? "rgba(45,255,106,.10)" : "rgba(255,77,109,.10)";
  elNote.textContent = degenActive ? "DEGEN: chart instability at MAX." : "Totally organic growth (trust me bro)";

  sessionStorage.setItem("gbaron_m_price", String(price));
}

/* =========================
   FLASH / DEGEN PULSE (very visible)
   ========================= */
function flash(el, color){
  if(!el) return;
  el.style.setProperty("--flash", color);
  el.classList.remove("flashGlow");
  void el.offsetWidth;
  el.classList.add("flashGlow");
  setTimeout(()=>el.classList.remove("flashGlow"), 650);
}
function flashTimes(el, color, times=7, gap=180){
  let i = 0;
  const tick = () => {
    i++;
    flash(el, color);
    if(i < times) setTimeout(tick, gap);
  };
  tick();
}

/* =========================
   COPY CA
   ========================= */
async function copyCA(){
  try{
    await navigator.clipboard.writeText(CA);
    toast.classList.add("show");
    setTimeout(()=>toast.classList.remove("show"), 1200);
    enqueue(["CLIPBOARD: WRITE_OK","CA COPIED // BARON APPROVES","NEXT: PASTE INTO SWAP"]);
  }catch(e){
    // fallback
    const ta = document.createElement("textarea");
    ta.value = CA;
    document.body.appendChild(ta);
    ta.select();
    try{ document.execCommand("copy"); }catch(_){}
    document.body.removeChild(ta);
    toast.classList.add("show");
    setTimeout(()=>toast.classList.remove("show"), 1200);
    enqueue(["CLIPBOARD: FALLBACK_COPY()","CA COPIED (LEGACY MODE)","PROCEED."]);
  }
}

/* =========================
   AUDIO (SFX + tracks; no overlap with DEGEN)
   ========================= */
let ac = null, sfxGain = null;

function ensureAC(){
  if(!audioEnabled) return null;
  const Ctx = window.AudioContext || window.webkitAudioContext;
  if(!Ctx) return null;
  if(!ac){
    ac = new Ctx();
    sfxGain = ac.createGain();
    sfxGain.gain.value = 0.9;
    sfxGain.connect(ac.destination);
  }
  if(ac.state === "suspended"){ ac.resume().catch(()=>{}); }
  return ac;
}
function setSfxDucked(ducked){
  if(!sfxGain) return;
  sfxGain.gain.value = ducked ? 0.0 : 0.9;
}
function blip(freq=720, dur=0.035, type="square", gain=0.11){
  if(!audioEnabled) return;
  if(degenActive) return; // no overlap while baron.mp3 plays
  const ctx = ensureAC();
  if(!ctx || !sfxGain) return;

  const o = ctx.createOscillator();
  const g = ctx.createGain();
  o.type = type;
  o.frequency.value = freq;

  const t0 = ctx.currentTime;
  g.gain.setValueAtTime(0.0001, t0);
  g.gain.exponentialRampToValueAtTime(gain, t0 + 0.005);
  g.gain.exponentialRampToValueAtTime(0.0001, t0 + dur);

  o.connect(g); g.connect(sfxGain);
  o.start(t0);
  o.stop(t0 + dur + 0.02);
}
function sfxClick(){ blip(720, 0.035, "square", 0.11); }
function sfxOpen(){  blip(520, 0.055, "sawtooth", 0.09); }
function sfxBad(){   blip(180, 0.11, "square", 0.12); }

const degenAudio = new Audio(DEGEN_MP3);
degenAudio.preload = "auto";
degenAudio.loop = false;

const laughAudio = new Audio(LAUGH_MP3);
laughAudio.preload = "auto";
laughAudio.loop = false;

function safePlay(audioEl){
  if(!audioEnabled) return;
  try{ audioEl.currentTime = 0; }catch(e){}
  const p = audioEl.play();
  if(p && typeof p.catch === "function"){
    p.catch(()=>enqueue(["AUDIO: BLOCKED_BY_BROWSER","CLICK ONCE TO UNLOCK","READY."]));
  }
}
function stopAudio(audioEl){
  try{ audioEl.pause(); audioEl.currentTime = 0; }catch(e){}
}

/* =========================
   SOUND TOGGLE
   ========================= */
function setSoundUI(){
  soundToggle.classList.toggle("on", audioEnabled);
  soundToggle.setAttribute("aria-checked", audioEnabled ? "true" : "false");
  soundState.textContent = audioEnabled ? "on" : "off";
}
function toggleSound(){
  audioEnabled = !audioEnabled;
  sessionStorage.setItem("gbaron_m_sound", audioEnabled ? "1" : "0");
  setSoundUI();
  enqueue([`SOUND: ${audioEnabled ? "ON" : "OFF"}`, audioEnabled ? "ARCADE MODE: ENGAGED" : "MODE: SILENT VILLAIN", "READY."]);
}

/* =========================
   DEGEN + RUG
   ========================= */
function startDegen(){
  if(degenActive) return;

  stopAudio(laughAudio);

  degenActive = true;
  degenLabel.textContent = "DEGEN ACTIVATED";
  btnDegen.disabled = true;

  setSfxDucked(true);

  enqueue(["DEGEN MODE: ARMING VOLTAGE RAILSâ€¦","OVERCLOCK: ON // SLIPPAGE: WHATEVER","ROUTE: CHAOS ENGINE v1.0 (APPROVED)"]);

  // make it VERY visible
  flashTimes(pumpBtn, "rgba(200,255,47,.92)", 8, 170);

  safePlay(degenAudio);

  const end = () => {
    degenAudio.removeEventListener("ended", end);
    stopDegen();
  };
  degenAudio.addEventListener("ended", end);
}
function stopDegen(){
  degenActive = false;
  degenLabel.textContent = "ACTIVATE DEGEN";
  btnDegen.disabled = false;
  setSfxDucked(false);
  enqueue(["DEGEN MODE: OFF","NODE: STABLE (BORING)","READY."]);
}

function doRugPull(){
  stopAudio(degenAudio);
  if(degenActive) stopDegen();

  sfxBad();
  safePlay(laughAudio);

  enqueue(["WARNING: LP DRAIN INITIATED","RUG PULL: LIQUIDITY EVAPORATED","EXIT: THE BARON ALWAYS EXITS FIRST"]);

  // reset stats/price
  coinsInserted = 0;
  price = basePrice;

  sessionStorage.setItem("gbaron_m_coins", "0");
  sessionStorage.setItem("gbaron_m_price", String(price));

  updateUI(true);

  // quick dramatic pulses
  flashTimes(pumpBtn, "rgba(255,77,109,.85)", 3, 220);
}

/* =========================
   LINKS (terminal reacts)
   ========================= */
function wireLink(el, name){
  el.addEventListener("click", ()=>{
    ensureAC();
    sfxOpen();
    enqueue([`OPEN: ${name.toUpperCase()}`,"LINK: OPEN_IN_NEW_TAB","STATUS: OK"]);
  });
}

/* =========================
   UI INIT
   ========================= */
function updateUI(resetPct=false){
  elCoins.textContent = String(coinsInserted);
  setRankUI();
  elPrice.textContent = fmtUSD(price);
  if(resetPct){
    elPct.textContent = "+0.00%";
    elPct.style.color = "var(--good)";
    elPct.style.background = "rgba(45,255,106,.10)";
  }
  elNote.textContent = degenActive ? "DEGEN: chart instability at MAX." : "Totally organic growth (trust me bro)";
}

(function init(){
  caText.textContent = CA;
  setSoundUI();
  updateUI(true);

  enqueue(["INITIALIZING TERMINALâ€¦","THE BARON ALWAYS EXITS FIRST","READY FOR COINSâ€¦ INSERT TO BEGIN"]);

  // interactions
  btnInsert.addEventListener("click", ()=>{
    ensureAC();
    sfxClick();

    coinsInserted += 1;
    sessionStorage.setItem("gbaron_m_coins", String(coinsInserted));

    enqueue([`COIN ACCEPTED // COUNT: ${coinsInserted}`, degenActive ? "DEGEN ROUTE: ENABLED // PUMP x10" : "ROUTE: STANDARD PUMP", "EXECUTE: PRICE_UP()"]);

    updateUI(false);
    pumpPrice(1);

    if(degenActive){
      pumpPrice(0.55);
      pumpPrice(0.35);
      flash(btnInsert, "rgba(45,255,106,.85)");
    }
  });

  btnDegen.addEventListener("click", ()=>{
    ensureAC();
    startDegen();
  });

  btnRug.addEventListener("click", doRugPull);

  caBtn.addEventListener("click", ()=>{
    ensureAC();
    sfxClick();
    copyCA();
  });

  // sound switch
  soundToggle.addEventListener("click", ()=>{
    ensureAC();
    toggleSound();
  });
  soundToggle.addEventListener("keydown", (e)=>{
    if(e.key === "Enter" || e.key === " "){
      e.preventDefault();
      ensureAC();
      toggleSound();
    }
  });

  // links -> terminal reacts
  wireLink(pumpBtn, "pump.fun");
  wireLink(dexBtn, "dexscreener");
  wireLink(xBtn, "twitter / x");
  wireLink(topPumpLink, "pump.fun (top)");

})();
</script>
</body>
</html>
